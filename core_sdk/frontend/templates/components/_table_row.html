{# core_sdk/frontend/templates/components/_table_row.html #}
{# Ожидает: item, model_name, fields (прототипы), ctx, row_hx_attrs (словарь), request, user, url_for #}
<tr ui_key="{{ model_name }}--{{ item.id }}" data-lsn="{{ item.lsn }}"
{% for attr, val in row_hx_attrs.items() %}
    {{ attr }}='{{ val|safe }}'
{% endfor %}
>
{% for field_prototype_ctx in fields %}
    {% if field_prototype_ctx.name not in ['id', 'lsn', 'vars', 'hashed_password'] and not field_prototype_ctx.extra.get('table_hidden') %}
        {% set cell_value = item[field_prototype_ctx.name] %}
        {% set cell_specific_field_ctx = field_prototype_ctx.model_copy(update={'value': cell_value }) %}
        {% with field_ctx=cell_specific_field_ctx, item=item, model_name=model_name, request=request, user=user, url_for=url_for %}
            {% include "components/_table_cell.html" %}
        {% endwith %}
    {% endif %}
{% endfor %}
<td class="text-end">
    {# Кнопка Просмотр #}
    <a href="#" class="avtar avtar-xs mx-1 btn-link-secondary"
       title="Просмотр {{ model_name }}"
       hx-get="{{ url_for('get_view', model_name=model_name, item_id=item.id) }}"
       hx-target="#modal-placeholder" {# <--- ИЗМЕНЕНИЕ: Цель - модальный плейсхолдер #}
       hx-swap="innerHTML" {# <--- ИЗМЕНЕНИЕ: Заменяем содержимое плейсхолдера #}
       {# hx-push-url можно убрать, если просмотр в модалке не должен менять URL страницы #}
       {# или оставить, если это желаемое поведение #}
       hx-indicator="closest tr">
        <i class="ti ti-eye f-20"></i>
    </a>

    {# Кнопка Редактировать #}
    {% if ctx.can_edit %}
        <a href="#" class="avtar avtar-xs mx-1 btn-link-secondary"
           title="Редактировать {{ model_name }}"
           hx-get="{{ url_for('get_edit_form', model_name=model_name, item_id=item.id) }}"
           hx-target="#modal-placeholder" {# Загружаем форму редактирования в модальное окно #}
           hx-swap="innerHTML"
           hx-indicator="closest tr">
            <i class="ti ti-edit f-20"></i>
        </a>
    {% endif %}

    {# Кнопка Удалить #}

        <a href="#" class="avtar avtar-xs mx-1 btn-link-secondary"
           title="Удалить {{ model_name }}"
           hx-get="{{ url_for('get_confirm_delete_modal', model_name=model_name, item_id=item.id) }}"
           hx-target="#modal-placeholder" {# Загружаем модалку подтверждения #}
           hx-swap="innerHTML"
           hx-indicator="closest tr">
            <i class="ti ti-trash f-20"></i>
        </a>

</td>
</tr>