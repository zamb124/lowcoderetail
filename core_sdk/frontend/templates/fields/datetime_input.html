{# core_sdk/frontend/templates/fields/datetime_input.html #}
{# Ожидает: field_ctx #}
{# Используем datetime-local, который ожидает значение в формате YYYY-MM-DDTHH:MM #}
{% set current_value = '' %}
{% if field_ctx.value and hasattr(field_ctx.value, 'strftime') %}
    {# Попытка форматировать, если это объект datetime #}
    {% if field_ctx.value.year > 1 and field_ctx.value.month > 0 %} {# Простая проверка на валидность даты #}
        {% set current_value = field_ctx.value.strftime('%Y-%m-%dT%H:%M') %}
    {% endif %}
{% elif field_ctx.value is string and field_ctx.value %}
    {# Если значение уже строка, пытаемся использовать его, если оно похоже на нужный формат #}
    {% if field_ctx.value | length > 15 and 'T' in field_ctx.value %}
        {% set current_value = field_ctx.value %}
    {% endif %}
{% endif %}

<div class="form-floating mb-3">
    <input type="datetime-local"
           class="form-control {% if field_ctx.errors %}is-invalid{% endif %}"
           id="{{ field_ctx.html_id }}"
           name="{{ field_ctx.html_name }}"
           value="{{ current_value }}"
           placeholder="{{ field_ctx.label }}"
           {% if field_ctx.is_readonly %}readonly disabled{% endif %}
           {% if field_ctx.is_required %}required{% endif %}
           aria-describedby="{{ field_ctx.html_id }}_errors"
           {% for attr, val in field_ctx.extra.items() if attr.startswith('hx-') %}
               {{ attr }}="{{ val }}"
           {% endfor %}>
    <label for="{{ field_ctx.html_id }}">
        {{ field_ctx.label }}{% if field_ctx.is_required %}<span class="text-danger">*</span>{% endif %}

    </label>
{% if field_ctx.description %}
            <span class="form-floating-info-icon"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  data-bs-container="{% if ctx and ctx.extra and ctx.extra.modal_container_id %}{{ '#' ~ ctx.extra.modal_container_id }}{% else %}body{% endif %}"
                  title="{{ field_ctx.description | escape }}">
        <i class="ti ti-info-circle text-muted"></i>
    </span>
        {% endif %}

    {% if field_ctx.errors %}
        <div class="invalid-feedback">
            {{ field_ctx.errors | join(', ') }}
        </div>
    {% endif %}
</div>