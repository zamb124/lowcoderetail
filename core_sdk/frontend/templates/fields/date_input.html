{# core_sdk/frontend/templates/fields/date_input.html #}
{# Ожидает: field_ctx #}
{% set current_value = '' %}
{% if field_ctx.value and hasattr(field_ctx.value, 'strftime') %}
    {% if field_ctx.value.year > 1 and field_ctx.value.month > 0 %}
      {% set current_value = field_ctx.value.strftime('%Y-%m-%d') %}
    {% endif %}
{% elif field_ctx.value is string and field_ctx.value %}
    {% if field_ctx.value | length > 8 %} {# Простая проверка на длину строки даты #}
        {% set current_value = field_ctx.value %}
    {% endif %}
{% endif %}

<div class="form-floating mb-3">
    <input type="date"
           class="form-control {% if field_ctx.errors %}is-invalid{% endif %}"
           id="{{ field_ctx.html_id }}"
           name="{{ field_ctx.html_name }}"
           value="{{ current_value }}"
           placeholder="{{ field_ctx.label }}"
           {% if field_ctx.is_readonly %}readonly disabled{% endif %}
           {% if field_ctx.is_required %}required{% endif %}
           aria-describedby="{{ field_ctx.html_id }}_errors"
           {% for attr, val in field_ctx.extra.items() if attr.startswith('hx-') %}
               {{ attr }}="{{ val }}"
           {% endfor %}>
    <label for="{{ field_ctx.html_id }}">
        {{ field_ctx.label }}{% if field_ctx.is_required %}<span class="text-danger">*</span>{% endif %}
        {% if field_ctx.description %}
            <i class="ti ti-info-circle ms-1 text-muted"
               style="cursor: help; font-size: 0.9em;"
               data-bs-toggle="tooltip"
               data-bs-placement="top"
               data-bs-container="{{ '#' ~ ctx.extra.modal_container_id if ctx and ctx.extra and ctx.extra.modal_container_id else 'body' }}"
               title="{{ field_ctx.description | escape }}"></i>
        {% endif %}
    </label>

    {% if field_ctx.errors %}
        <div class="invalid-feedback">
            {{ field_ctx.errors | join(', ') }}
        </div>
    {% endif %}
</div>